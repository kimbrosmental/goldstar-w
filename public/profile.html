<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>내 정보</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body{padding-top:100px;}
    .profile-wrapper{max-width:860px;margin:0 auto;color:#fff;padding:10px 20px 60px;}
    .profile-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;}
    .profile-card{background:#102522;border:1px solid #1d4d46;padding:28px 30px;border-radius:18px;margin-bottom:40px;box-shadow:0 0 18px rgba(0,0,0,0.4);}
    .profile-card h2{font-size:22px;margin-bottom:16px;color:#FFD700;}
    .profile-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:14px;}
    .field{background:#0c1a18;padding:14px 16px;border-radius:10px;}
    .field label{display:block;font-size:12px;color:#90a4ae;letter-spacing:.5px;margin-bottom:4px;}
    .field span{font-weight:600;font-size:15px;}
    .orders-table{width:100%;border-collapse:collapse;margin-top:10px;}
    .orders-table th,.orders-table td{border:1px solid #1e4d47;padding:10px 12px;font-size:14px;}
    .orders-table th{background:#004d40;color:#FFD700;}
    .orders-empty{color:#bbb;font-size:14px;margin-top:8px;}
    .actions{display:flex;gap:10px;margin-top:14px;}
    .btn{background:#00695C;color:#fff;padding:10px 16px;border:none;border-radius:8px;font-size:14px;cursor:pointer;transition:.3s;}
    .btn:hover{background:#00897B;}
    .danger{background:#b71c1c;}
    .danger:hover{background:#d32f2f;}
  </style>
</head>
<body>
  <nav id="navbar" style="position:fixed;top:0;left:0;width:100%;">
    <div class="container">
      <div class="logo"><img src="img/logo.png" alt="logo"/></div>
      <ul class="nav-links">
        <li><a href="index.html#section1">소개</a></li>
        <li><a href="index.html#section2">진행</a></li>
        <li><a href="index.html#section3">영상</a></li>
        <li><a href="index.html#section4">이력</a></li>
        <li><a href="index.html#section5">문의</a></li>
      </ul>
      <div class="right-tools">
        <a href="index.html" style="color:#fff;font-size:14px;">홈</a>
      </div>
    </div>
  </nav>
  <main>
    <div class="profile-wrapper">
      <div class="profile-header">
        <h1 style="font-size:30px;color:#4fc3f7;">내 정보</h1>
        <div class="actions">
          <button class="btn" id="mockOrderBtn">모의 주문 추가</button>
          <button class="btn danger" id="logoutBtn">로그아웃</button>
        </div>
      </div>
      <div class="profile-card" id="profileCard" hidden>
        <h2>회원 기본 정보</h2>
        <div class="profile-grid" id="profileGrid"></div>
      </div>
      <div class="profile-card">
        <h2>주문 내역</h2>
        <div id="ordersContainer"></div>
      </div>
    </div>
  </main>
  <script>
    function loadProfile(){
      const raw = localStorage.getItem('member_profile');
      if(!raw){
        if(confirm('로그인/회원가입 정보가 없습니다. 회원가입 하시겠습니까?')){
          window.location.href='signup.html';
        }
        return;
      }
      const data = JSON.parse(raw);
      const grid = document.getElementById('profileGrid');
      const profileCard = document.getElementById('profileCard');
      profileCard.hidden=false;
      grid.innerHTML = '';
      const fields = [
        ['이름', data.name],
        ['생년월일', data.birth],
        ['연락처', data.phone],
        ['이메일', data.email],
        ['가입일', new Date(data.created).toLocaleString('ko-KR')]
      ];
      fields.forEach(([label,val])=>{
        const div=document.createElement('div');
        div.className='field';
        div.innerHTML=`<label>${label}</label><span>${val||'-'}</span>`;
        grid.appendChild(div);
      });
      renderOrders(data.orders||[]);
    }
    function renderOrders(list){
      const container = document.getElementById('ordersContainer');
      if(!list.length){
        container.innerHTML = '<div class="orders-empty">주문 내역이 없습니다.</div>';
        return;
      }
      let html = '<table class="orders-table"><thead><tr><th>주문번호</th><th>상품</th><th>수량(g)</th><th>가격</th><th>일시</th></tr></thead><tbody>';
      html += list.map(o=>`<tr><td>${o.id}</td><td>${o.item}</td><td style="text-align:right;">${o.qty}</td><td style="text-align:right;">${o.price.toLocaleString('ko-KR')}원</td><td>${new Date(o.ts).toLocaleString('ko-KR')}</td></tr>`).join('');
      html+='</tbody></table>';
      container.innerHTML = html;
    }
    document.getElementById('logoutBtn').addEventListener('click',()=>{
      if(confirm('로그아웃 하시겠습니까?')){
        localStorage.removeItem('member_profile');
        window.location.href='index.html';
      }
    });
    document.getElementById('mockOrderBtn').addEventListener('click',()=>{
      const raw = localStorage.getItem('member_profile');
      if(!raw){alert('회원 정보 없음');return;}
      const data = JSON.parse(raw);
      const order = {
        id: 'O'+Date.now().toString(36),
        item: '골드바 3.75g',
        qty: 3.75,
        price: Math.round(500000 + Math.random()*50000),
        ts: Date.now()
      };
      data.orders = data.orders || [];
      data.orders.unshift(order);
      localStorage.setItem('member_profile', JSON.stringify(data));
      renderOrders(data.orders);
    });
    loadProfile();
  </script>
</body>
</html>
